<div x-data="filters()" @reset="reset = $event.detail.reset, filterCounter = 0">
  <ul class="px-2" x-show="dev">
    <li class="py-3">
      filterCounter:
      <span x-text="filterCounter"></span>
    </li>
    <li class="py-3">
      resetCounter:
      <span x-text="resetCounter"></span>
    </li>
    <li class="py-3">
      reset:
      <span x-text="reset"></span>
    </li>
  </ul>
  <hr />
  <div class="flex items-center">
    <div class="flex items-start">
      <div
        x-ref="myFilter"
        class="myFilters"
        x-data="{
                show: false,
                counter: 0,
              }
              "
        @reset.window="counter = 0">
        <div x-on:click="open" class="m-1 bg-white p-2 text-red-600">
          Open A
          <span
            x-show="counter"
            x-text="counter"
            class="ml-2 rounded-md bg-green-500 p-2 text-white"></span>
        </div>
        <ul x-show="isOpen()" x-on:click.away="close">
          <li
            x-data="{ 
                  checked: false
                }"
            @reset.window="checked = false">
            <button
              @click="count"
              :class="checked ? 'bg-green-500' : 'bg-red-500'"
              class="m-1  p-2 text-white">
              option 1A
            </button>
          </li>
          <li
            x-data="{ 
                  checked: false
                }"
            @reset.window="checked = false">
            <button
              @click="count"
              :class="checked ? 'bg-green-500' : 'bg-red-500'"
              class="m-1  p-2 text-white">
              option 2A
            </button>
          </li>
        </ul>
      </div>
      <div
        x-ref="myFilter"
        class="myFilters"
        x-data="{
                show: false,
                counter: 0,
              }
              "
        @reset.window="counter = 0">
        <div x-on:click="open" class="m-1 bg-white p-2 text-red-600">
          Open B
          <span
            x-show="counter"
            x-text="counter"
            class="ml-2 rounded-md bg-green-500 p-2 text-white"></span>
        </div>
        <ul x-show="isOpen()" x-on:click.away="close">
          <li
            x-data="{ 
                  checked: false
                }"
            @reset.window="checked = false">
            <button
              @click="count"
              :class="checked ? 'bg-green-500' : 'bg-red-500'"
              class="m-1  p-2 text-white">
              option 1B
            </button>
          </li>
          <li
            x-data="{ 
                  checked: false
                }"
            @reset.window="checked = false">
            <button
              @click="count"
              :class="checked ? 'bg-green-500' : 'bg-red-500'"
              class="m-1  p-2 text-white">
              option 2B
            </button>
          </li>
        </ul>
      </div>
      <div>
        <button
          @click="$dispatch( 'reset', { reset : !reset } )"
          x-show="filterCounter"
          class="m-1 bg-green-500 p-2 text-white">
          Reset
        </button>
      </div>
    </div>
  </div>
</div>
<script>
  function filters() {
    return {
      dev: false,
      filterCounter: 0,
      reset: false,
      resetCounter: false,
      open() {
        this.show = true;
      },
      close() {
        this.show = false;
      },

      isOpen() {
        return this.show === true;
      },

      count() {
        this.show = false;
        this.checked = !this.checked;
        if (this.checked) {
          this.counter = this.counter + 1;
          this.filterCounter = this.filterCounter + 1;
        } else if (!this.checked) {
          this.counter = this.counter - 1;
          this.filterCounter = this.filterCounter - 1;
        }
      },
    };
  }
</script>
{{/* <div class="flex">
  <div class="flex">
  <div
  x-ref="myFilter"
  x-data="{
  show: false,
  counter: 0,
  updateFilter: myFilters(reset)
  }
  ">
  <div x-on:click="open" class="m-1 bg-white p-2 text-red-600">
  Open A
  <span x-text="reset"></span>
  <span x-show="counter" x-text="counter"></span>
  </div>
  <ul x-show="isOpen()" x-on:click.away="close">
  <li
  x-data="{
  checked: false
  }">
  <button
  @click="count"
  :class="checked ? 'bg-green-500' : 'bg-red-500'"
  class="m-1  p-2 text-white">
  option A
  </button>
  </li>
  <li
  x-data="{
  checked: false
  }">
  <button
  @click="count"
  :class="checked ? 'bg-green-500' : 'bg-red-500'"
  class="m-1  p-2 text-white">
  option A
  </button>
  </li>
  </ul>
  </div>
  <div
  x-ref="myFilter"
  class="myFilters"
  x-data="{
  show: false,
  counter: 0,
  updateFilter: myFilters(reset)
  }
  ">
  <div x-on:click="open" class="m-1 bg-white p-2 text-blue-600">
  Open B
  <span x-text="reset"></span>
  <span x-show="counter" x-text="counter"></span>
  </div>
  <ul x-show="isOpen()" x-on:click.away="close">
  <li
  x-data="{
  checked: false
  }">
  <button
  @click="count"
  :class="checked ? 'bg-green-500' : 'bg-blue-500'"
  class="m-1  p-2 text-white">
  option B
  </button>
  </li>
  <li
  x-data="{
  checked: false
  }">
  <button
  @click="count"
  :class="checked ? 'bg-green-500' : 'bg-blue-500'"
  class="m-1  p-2 text-white">
  option B
  </button>
  </li>
  <li
  x-data="{
  checked: false
  }">
  <button
  @click="count"
  :class="checked ? 'bg-green-500' : 'bg-blue-500'"
  class="m-1  p-2 text-white">
  option B
  </button>
  </li>
  </ul>
  </div>
  <div
  x-ref="myFilter"
  class="myFilters"
  x-data="{
  show: false,
  counter: 0,
  updateFilter: myFilters(reset)
  }
  ">
  <div x-on:click="open" class="m-1 bg-white p-2 text-pink-600">
  Open C
  <span x-text="reset"></span>
  <span x-show="counter" x-text="counter"></span>
  </div>
  <ul x-show="isOpen()" x-on:click.away="close">
  <li
  x-data="{
  checked: false
  }">
  <button
  @click="count"
  :class="checked ? 'bg-green-500' : 'bg-pink-500'"
  class="m-1  p-2 text-white">
  option C
  </button>
  </li>
  <li
  x-data="{
  checked: false
  }">
  <button
  @click="count"
  :class="checked ? 'bg-green-500' : 'bg-pink-500'"
  class="m-1  p-2 text-white">
  option C
  </button>
  </li>
  <li
  x-data="{
  checked: false
  }">
  <button
  @click="count"
  :class="checked ? 'bg-green-500' : 'bg-pink-500'"
  class="m-1  p-2 text-white">
  option C
  </button>
  </li>
  </ul>
  </div>
  </div>
  </div>
  */}}
