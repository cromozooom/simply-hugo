<div
  class="m-4"
  x-data="{a: [1,2,3,4,5], dragging: null, dropping: null, timer: null}"
  @drop.prevent="
        if(dragging !== null && dropping !== null) {
            if (dragging < dropping) a = [...a.slice(0, dragging),...a.slice(dragging + 1, dropping + 1),a[dragging],...a.slice(dropping + 1)];
            else a = [...a.slice(0, dropping), a[dragging], ...a.slice(dropping, dragging), ...a.slice(dragging + 1)]
        };
        dropping = null;"
  @dragover.prevent='$event.dataTransfer.dropEffect = "move"'
>
  <div x-text="`Drag=${String(dragging)} Drop=${String(dropping)}`"></div>
  <div class="mt-2 h-64 overflow-auto bg-gray-400 p-8">
    <template x-for="(i, index) in a" :key="i">
      <div class="relative mt-2 flex items-center rounded border bg-white p-4" draggable="true" :class="{'border-blue-600': dragging === index}" @dragstart="dragging = index" @dragend="dragging = null">
        <i class="fas fa-grip-vertical cursor-move"></i>
        <div class="ml-2"><span>Draggable Item </span><span x-text="i"></span></div>
        <div class="absolute inset-0 opacity-50" x-show.transition="dragging !== null" :class="{'bg-blue-200': dropping === index}" @dragenter.prevent="if(index !== dragging) {dropping = index}" @dragleave="if(dropping === index) dropping = null"></div>
      </div>
    </template>
  </div>
</div>

<div class="drag-and-drop" x-data="{ adding: false, removing: false }">
  <div class="drag-and-drop__container drag-and-drop__container--from">
    <h3 class="drag-and-drop__title">From</h3>
    <ul
      class="drag-and-drop__items container"
      :class="{ 'drag-and-drop__items--removing': removing }"
      x-on:drop="removing = false"
      x-on:drop.prevent="
                const target = event.target.closest('.container');
                const element = document.getElementById(event.dataTransfer.getData('text/plain'));
                target.appendChild(element);
            "
      x-on:dragover.prevent="removing = true"
      x-on:dragleave.prevent="removing = false"
    >
      <!-- loop through the items -->
      <li
        id="item-1"
        class="drag-and-drop__item"
        :class="{ 'drag-and-drop__item--dragging': dragging }"
        x-on:dragstart.self="
                    dragging = true;
                    event.dataTransfer.effectAllowed='move';
                    event.dataTransfer.setData('text/plain', event.target.id);
                "
        x-on:dragend="dragging = false"
        x-data="{ dragging: false }"
        draggable="true"
      >
        Your Item #1
      </li>
      <li
        id="item-2"
        class="drag-and-drop__item"
        :class="{ 'drag-and-drop__item--dragging': dragging }"
        x-on:dragstart.self="
                    dragging = true;
                    event.dataTransfer.effectAllowed='move';
                    event.dataTransfer.setData('text/plain', event.target.id);
                "
        x-on:dragend="dragging = false"
        x-data="{ dragging: false }"
        draggable="true"
      >
        Your Item #2
      </li>
      <li
        id="item-3"
        class="drag-and-drop__item"
        :class="{ 'drag-and-drop__item--dragging': dragging }"
        x-on:dragstart.self="
                    dragging = true;
                    event.dataTransfer.effectAllowed='move';
                    event.dataTransfer.setData('text/plain', event.target.id);
                "
        x-on:dragend="dragging = false"
        x-data="{ dragging: false }"
        draggable="true"
      >
        Your Item #3
      </li>
      <li
        id="item-4"
        class="drag-and-drop__item"
        :class="{ 'drag-and-drop__item--dragging': dragging }"
        x-on:dragstart.self="
                    dragging = true;
                    event.dataTransfer.effectAllowed='move';
                    event.dataTransfer.setData('text/plain', event.target.id);
                "
        x-on:dragend="dragging = false"
        x-data="{ dragging: false }"
        draggable="true"
      >
        Your Item #4
      </li>
      <li
        id="item-5"
        class="drag-and-drop__item"
        :class="{ 'drag-and-drop__item--dragging': dragging }"
        x-on:dragstart.self="
                    dragging = true;
                    event.dataTransfer.effectAllowed='move';
                    event.dataTransfer.setData('text/plain', event.target.id);
                "
        x-on:dragend="dragging = false"
        x-data="{ dragging: false }"
        draggable="true"
      >
        Your Item #5
      </li>
      <li
        id="item-6"
        class="drag-and-drop__item"
        :class="{ 'drag-and-drop__item--dragging': dragging }"
        x-on:dragstart.self="
                    dragging = true;
                    event.dataTransfer.effectAllowed='move';
                    event.dataTransfer.setData('text/plain', event.target.id);
                "
        x-on:dragend="dragging = false"
        x-data="{ dragging: false }"
        draggable="true"
      >
        Your Item #6
      </li>
    </ul>
  </div>
  <div class="drag-and-drop__divider">⇄</div>
  <div class="drag-and-drop__container drag-and-drop__container--to">
    <h3 class="drag-and-drop__title">To</h3>
    <ul
      class="drag-and-drop__items container"
      :class="{ 'drag-and-drop__items--adding': adding }"
      x-on:drop="adding = false"
      x-on:drop.prevent="
                const target = event.target.closest('.container');
                const element = document.getElementById(event.dataTransfer.getData('text/plain'));
                target.appendChild(element);
            "
      x-on:dragover.prevent="adding = true"
      x-on:dragleave.prevent="adding = false"
    >
      <!-- loop through the already selected items -->
    </ul>
  </div>
</div>

<!-- <div class="drag-and-drop flex justify-center p-4" x-data="{ adding: false, removing: false }">
  <div class="drag-and-drop__container drag-and-drop__container--from">
    <h3 class="drag-and-drop__title">From</h3>
    <ul
      class="drag-and-drop__items flex min-w-[10rem] flex-col border"
      :class="{ 'ring ring-blue-300 ring-offset-2': adding }"
      x-on:drop="removing = false"
      x-on:drop.prevent="
        const target = event.target.closest('ul');
        const element = document.getElementById(event.dataTransfer.getData('text/plain'));
        target.appendChild(element);
    "
      x-on:dragover.prevent="removing = true"
      x-on:dragleave.prevent="removing = false"
    >
      <li
        id="item-1"
        x-data="{ dragging: false }"
        class="drag-and-drop__item p-4"
        :class="{ 'ring ring-blue-500 ring-offset-2': dragging }"
        x-on:dragstart.self="
            dragging = true;
            event.dataTransfer.effectAllowed = 'move';
            event.dataTransfer.setData('text/plain', event.target.id);
      "
        x-on:dragend="dragging = false"
        draggable="true"
      >
        item 1
      </li>
      <li
        id="item-2"
        x-data="{ dragging: false }"
        class="drag-and-drop__item p-4"
        :class="{ 'ring ring-blue-500 ring-offset-2': dragging }"
        x-on:dragstart.self="
            dragging = true;
            event.dataTransfer.effectAllowed = 'move';
            event.dataTransfer.setData('text/plain', event.target.id);
      "
        x-on:dragend="dragging = false"
        draggable="true"
      >
        >item 2
      </li>
    </ul>
  </div>
  <div class="drag-and-drop__divider">⇄</div>
  <div class="drag-and-drop__container drag-and-drop__container--to">
    <h3 class="drag-and-drop__title">To</h3>
    <ul
      class="drag-and-drop__items flex min-w-[10rem] flex-col border"
      :class="{ 'ring ring-blue-300 ring-offset-2': adding }"
      x-on:drop="removing = false"
      x-on:drop.prevent="
        const id = event.dataTransfer.getData('text/plain');
        const target = event.target.closest('ul');
        const element = document.getElementById(id);
        target.appendChild(element);
    "
      x-on:dragover.prevent="removing = true"
      x-on:dragleave.prevent="removing = false"
    >
      <li
        id="item-3"
        x-data="{ dragging: false }"
        class="drag-and-drop__item p-4"
        :class="{ 'ring ring-blue-500 ring-offset-2': dragging }"
        x-on:dragstart.self="
            dragging = true;
            event.dataTransfer.effectAllowed = 'move';
            event.dataTransfer.setData('text/plain', event.target.id);
      "
        x-on:dragend="dragging = false"
        draggable="true"
      >
        >item 3
      </li>
    </ul>
  </div>
</div>
<script>
  const target = event.target.closest("ul");
  const element = document.getElementById(event.dataTransfer.getData("text/plain"));
  target.appendChild(element);
</script> -->
